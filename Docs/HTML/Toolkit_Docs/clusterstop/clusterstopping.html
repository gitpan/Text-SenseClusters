<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>clusterstopping.pl</title>
<link rev="made" href="mailto:jluttine@marimba.d.umn.edu" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#usage">USAGE</a></li>
	<li><a href="#input">INPUT</a></li>
	<ul>

		<li><a href="#required_arguments_">Required Arguments:</a></li>
		<ul>

			<li><a href="#inputfile">INPUTFILE</a></li>
		</ul>

		<li><a href="#optional_arguments_">Optional Arguments:</a></li>
		<ul>

			<ul>

				<li><a href="#prefix_pre">-prefix PRE</a></li>
				<li><a href="#measure_msr">-measure MSR</a></li>
				<li><a href="#space_sp">-space SP</a></li>
				<li><a href="#delta_int">-delta INT</a></li>
				<li><a href="#clmethod_cl">-clmethod CL</a></li>
				<li><a href="#crfun_cr">-crfun CR</a></li>
				<li><a href="#rowmodel_rmod">-rowmodel RMOD</a></li>
				<li><a href="#threspk1_num">-threspk1 NUM</a></li>
				<li><a href="#precision_num">-precision NUM</a></li>
			</ul>

			<li><a href="#adapted_gap_statistic_related_options_">Adapted Gap Statistic related options:</a></li>
			<ul>

				<li><a href="#b_num">-B NUM</a></li>
				<li><a href="#typeref_typ">-typeref TYP</a></li>
				<li><a href="#seed_num">-seed NUM</a></li>
				<li><a href="#percentage_num">-percentage NUM</a></li>
			</ul>

			<li><a href="#other_options__">Other Options :</a></li>
			<ul>

				<li><a href="#help">-help</a></li>
				<li><a href="#version">-version</a></li>
				<li><a href="#verbose">-verbose</a></li>
			</ul>

		</ul>

	</ul>

	<li><a href="#output">OUTPUT</a></li>
	<li><a href="#details_about_the_clusterstopping_measures">DETAILS ABOUT THE CLUSTER-STOPPING MEASURES</a></li>
	<ul>

		<li><a href="#formulation_for_pk1_">Formulation for PK1:</a></li>
		<li><a href="#formulation_for_pk2_">Formulation for PK2:</a></li>
		<li><a href="#formulation_for_pk3_">Formulation for PK3:</a></li>
		<li><a href="#adapted_gap_statistic_">Adapted Gap Statistic:</a></li>
	</ul>

	<li><a href="#details_about_the_input_matrix_format">DETAILS ABOUT THE INPUT MATRIX FORMAT</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>clusterstopping.pl</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p>Predicts the optimal number of clusters for the given data.</p>
<p>
</p>
<hr />
<h1><a name="usage">USAGE</a></h1>
<p>clusterstopping.pl [OPTIONS] INPUTFILE</p>
<p>This script tries to find the optimal number of clusters for the given INPUTFILE.</p>
<p>
</p>
<hr />
<h1><a name="input">INPUT</a></h1>
<p>
</p>
<h2><a name="required_arguments_">Required Arguments:</a></h2>
<p>
</p>
<h3><a name="inputfile">INPUTFILE</a></h3>
<p>Matrix file containing either:
 * context vectors (in dense or sparse format)
 * similarity values between contexts</p>
<p>
</p>
<h2><a name="optional_arguments_">Optional Arguments:</a></h2>
<p>
</p>
<h4><a name="prefix_pre">--prefix PRE</a></h4>
<p>Specify a prefix to be used for the output filenames.</p>
<p>If prefix is not specified then prefix is created by concatenating
time stamp to the string ``expr''.</p>
<p>
</p>
<h4><a name="measure_msr">--measure MSR</a></h4>
<p>Specify the cluster stopping measure to be used.</p>
<p>(Further details about the measures given below under the Section ``DETAILS ABOUT THE CLUSTER-STOPPING MEASURES'')</p>
<p>The possible option values:
    pk1 - PK1 measure
    pk2 - PK2 measure
    pk3 - PK3 measure [Default]
    gap - Adapted Gap Statistic
    pk  - All the three PK measures
    all - All the four measures - PK1, PK2, PK3 and Gap</p>
<p>
</p>
<h4><a name="space_sp">--space SP</a></h4>
<p>Specify if the clustering should be performed in vector or similarity space.</p>
<p>The possible option values:
   vector [Default]
   similarity</p>
<p>
</p>
<h4><a name="delta_int">--delta INT</a></h4>
<p>NOTE: Delta value can only be a positive integer value.</p>
<p>Specify 0 to stop the iterating clustering process when two consecutive crfun values 
are exactly equal. This is the default setting when the crfun values are integer/whole numbers.</p>
<p>Specify non-zero positive integer to stop the iterating clustering process when the diffference 
between two consecutive crfun values is less than or equal to this value. However, note that the
integer value specified is internally shifted to capture the difference in the least significant 
digit of the crfun values when these crfun values are fractional.
 For example: 
    For crfun = 1.23e-02 &amp; delta = 1 will be transformed to 0.0001
    For crfun = 2.45e-01 &amp; delta = 5 will be transformed to 0.005
The default delta value when the crfun values are fractional is 1.</p>
<p>However if the crfun values are integer/whole numbers (exponent &gt;= 2) then the specified delta 
value is internally shifted only until the least significant digit in the scientific notation.
 For example: 
    For crfun = 1.23e+04 &amp; delta = 2 will be transformed to 200
    For crfun = 2.45e+02 &amp; delta = 5 will be transformed to 5
    For crfun = 1.44e+03 &amp; delta = 1 will be transformed to 10</p>
<p>
</p>
<h4><a name="clmethod_cl">--clmethod CL</a></h4>
<p>Specifies the clustering method.</p>
<p>The possible option values:
   rb - Repeated Bisections [Default]
   rbr - Repeated Bisections for by k-way refinement
   direct - Direct k-way clustering
   agglo  - Agglomerative clustering
   bagglo - Partitional biased Agglomerative clustering [Only in vector space]</p>
<p>For large amount of data, 'rb', 'rbr' or 'direct' are recommended.</p>
<p>
</p>
<h4><a name="crfun_cr">--crfun CR</a></h4>
<p>Selects the criteria function for Clustering. The meanings of these criteria
functions are explained in Cluto's manual.</p>
<p>The possible option values:
   i1      -  I1  Criterion function
   i2      -  I2  Criterion function [Default]
   h1      -  H1  Criterion function
   h2      -  H2  Criterion function
   e1      -  E1  Criterion function
</p>
<pre>

=head4 --sim SIM</pre>
<p>Specifies the similarity measure to be used</p>
<p>The possible option values:
   cos      -  Cosine [Default]
   corr     -  Correlation Coefficient
</p>
<pre>

NOTE: This option can be used only in vector space.</pre>
<p>
</p>
<h4><a name="rowmodel_rmod">--rowmodel RMOD</a></h4>
<p>The option is used to specify the model to be used to scale every 
column of each row. (For further details please refer Cluto manual)</p>
<p>The possible option values:
   none  -  no scaling is performed [Default]
   maxtf -  post scaling the values are between 0.5 and 1.0
   sqrt  -  square-root of actual values
   log   -  log of actual values
</p>
<pre>

=head4 --colmodel CMOD</pre>
<p>The option is used to specify the model to be used to (globally) scale each 
column across all rows. (For further details please refer Cluto manual)</p>
<p>The possible option values:
   none  -  no scaling is performed [Default]
   idf   -  scaling according to inverse-document-frequency</p>
<p>
</p>
<h4><a name="threspk1_num">--threspk1 NUM</a></h4>
<p>The threshold value that should be used by the PK1 measure to predict the
k value.</p>
<p>Default = -0.7</p>
<p>
</p>
<h4><a name="precision_num">--precision NUM</a></h4>
<p>Specifies the precision to be used.</p>
<p>Default: 4</p>
<p>
</p>
<h3><a name="adapted_gap_statistic_related_options_">Adapted Gap Statistic related options:</a></h3>
<p>
</p>
<h4><a name="b_num">--B NUM</a></h4>
<p>The number of replicates/references to be generated.</p>
<p>Default: 1</p>
<p>
</p>
<h4><a name="typeref_typ">--typeref TYP</a></h4>
<p>Specifies whether to generate B replicates from a reference or to generate 
B references.</p>
<p>The possible option values:
      rep - replicates [Default]
      ref - references</p>
<p>
</p>
<h4><a name="seed_num">--seed NUM</a></h4>
<p>The seed to be used with the random number generator.</p>
<p>Default: No seed is set.</p>
<p>
</p>
<h4><a name="percentage_num">--percentage NUM</a></h4>
<p>Specifies the percentage confidence to be reported in the log file.
Since Statistics::Gap uses parametric bootstrap method for reference distribution
generation, it is critical to understand the interval around the sample mean that
could contain the population (``true'') mean and with what certainty.</p>
<p>Default: 90</p>
<p>
</p>
<h3><a name="other_options__">Other Options :</a></h3>
<p>
</p>
<h4><a name="help">--help</a></h4>
<p>Displays the quick summary of program options.</p>
<p>
</p>
<h4><a name="version">--version</a></h4>
<p>Displays the version information.</p>
<p>
</p>
<h4><a name="verbose">--verbose</a></h4>
<p>Displays to STDERR the current program status.</p>
<p>
</p>
<hr />
<h1><a name="output">OUTPUT</a></h1>
<ul>
<li><strong><a name="item_prefix_2epk1">prefix.pk1</a></strong><br />
</li>
<pre>
 Contains the crfun values, PK1 values and the predicted k.</pre>
<li><strong><a name="item_prefix_2epk2">prefix.pk2</a></strong><br />
</li>
<pre>
 Contains the crfun values, PK2 values and the predicted k.</pre>
<li><strong><a name="item_prefix_2epk3">prefix.pk3</a></strong><br />
</li>
<pre>
 Contains the crfun values, PK3 values and the predicted k.</pre>
<li><strong><a name="item_prefix_2egap">prefix.gap</a></strong><br />
</li>
<pre>
 Contains the crfun values, delta values and the predicted k.</pre>
<li><strong><a name="item_gap">prefix.gap.log
 Contains a table of values for Gap(k), Obs(crfun(k)), Exp(crfun(k)), sd(k), <code>s(k)</code> and Confidence interval.
 Also contains individual crfun values for each of the B replicates/references for every value of K.</a></strong><br />
</li>
</ul>
<p>The following files (*.dat) files are created to facilitate
creation of plots if required.</p>
<ul>
<li><strong><a name="item_prefix_2ecr_2edat">prefix.cr.dat</a></strong><br />
</li>
<pre>
 Contains the crfun values.</pre>
<li><strong><a name="item_prefix_2epk1_2edat">prefix.pk1.dat</a></strong><br />
</li>
<pre>

 Contains the PK1 values.</pre>
<li><strong><a name="item_prefix_2epk2_2edat">prefix.pk2.dat</a></strong><br />
</li>
<pre>
 Contains the PK2 values.</pre>
<li><strong><a name="item_prefix_2epk3_2edat">prefix.pk3.dat</a></strong><br />
</li>
<pre>
 Contains the PK3 values.</pre>
<li><strong><a name="item_prefix_2eexp_2edat">prefix.exp.dat</a></strong><br />
</li>
<pre>
 Contains the Exp(crfun(k)) values generated for Gap Statistics.</pre>
<li><strong><a name="item_prefix_2egap_2edat">prefix.gap.dat</a></strong><br />
</li>
<pre>
 Contains the gap(k) values.</pre>
</ul>
<p>
</p>
<hr />
<h1><a name="details_about_the_clusterstopping_measures">DETAILS ABOUT THE CLUSTER-STOPPING MEASURES</a></h1>
<p>Each of the four cluster-stopping measure PK1, PK2, PK3 and Gap try to predict
the optimal number of clusters for the provided data (represented in the form 
of vectors or similarity values).</p>
<p>Following is a description about each of the measures and how they select a k value.</p>
<p>
</p>
<h2><a name="formulation_for_pk1_">Formulation for PK1:</a></h2>
<pre>
           crfun[m] - mean(crfun[1...deltaM])
 PK1[m] = -----------------------------------
                std(crfun[1...deltaM])</pre>
<pre>
 where m = 2,...deltaM
 deltaM is a m value beyond which the crfun value does not change much.</pre>
<p>k selection strategy: If m is the first value for which the PK1 score is 
greater than the threshold value then m-1 value is selected as the k value 
when using one of the maximization criterion functions like I2, H2 etc. 
While using minimization criterion functions like E1, if m the first value 
for which the PK1 score is less than the threshold value then m-1 is 
selected as the k value.</p>
<p>
</p>
<h2><a name="formulation_for_pk2_">Formulation for PK2:</a></h2>
<pre>
            crfun[m]
 PK2[m] = ------------
           crfun[m-1]</pre>
<p>where m = 2,...deltaM</p>
<p>k selection strategy: One standard deviation interval for the set of PK2[m]
values id calculated and the m value for which the PK2 score is outside this
interval but is still closest to the interval (from outside) is selected as
the k value.</p>
<p>
</p>
<h2><a name="formulation_for_pk3_">Formulation for PK3:</a></h2>
<pre>
                2 * crfun[m]
 PK3[m] = -------------------------
           crfun[m-1] + crfun[m+1]
 
where m = 2,...deltaM</pre>
<p>k selection strategy: Similar to that of PK2. One standard deviation of the 
PK3[m] scores is computed and the m value for which the PK3 score is outside 
this interval but is still closest to the interval (from outside) is selected 
as the k value.</p>
<p>
</p>
<h2><a name="adapted_gap_statistic_">Adapted Gap Statistic:</a></h2>
<p>Adapted Gap tries to predict the optimal number of clusters by comparing the 
criterion function values that one gets for the observed/given data with the 
criterion function values that one gets for a random data. It uses hypothesis
testing in this process where the null hypothesis is that the optimal number 
of clusters for the given data is 1 and the aim is to refute this null 
hypothesis if the given data exhibits enough pattern.</p>
<p>The plot of crfun values for given data is compared with the plot of crfun 
values for random or reference data. The m value corresponding to the first 
point of maximum difference between the two plots is chosen as the predicted 
k when using the maximization crfuns. While for the minimization crfuns, the 
m value corresponding to the first point of minimum difference between the
two plots is choosen as the predicted k value.</p>
<p>We provide two methods for the generation of reference data:</p>
<p>1. One can choose to generate a random dataset over the observed distribution by 
holding the row and the column marginals fixed and then generating B replicates 
from this random dataset using Monte Carlo sampling.
</p>
<pre>

2. Or to generate B random datasets over the observed distribution by holding 
the row and the column marginals fixed.</pre>
<p>Please refer to <a href="http://search.cpan.org/dist/Algorithm-RandomMatrixGeneration/">http://search.cpan.org/dist/Algorithm-RandomMatrixGeneration/</a> to
learn more about generating random dataset over the observed distribution by holding
the row and the column marginals fixed.</p>
<p>
</p>
<hr />
<h1><a name="details_about_the_input_matrix_format">DETAILS ABOUT THE INPUT MATRIX FORMAT</a></h1>
<p>The input matrix can be in either dense or sparse format. The cell values can 
be integer or real. Depending upon the value specified for the space parameter 
the header in the input file (first line) changes.</p>
<p>Example of input matrix in dense format when space=vector:
 The first line specifies the dimensions - #rows #cols
 From the second line the actual matrix follows.</p>
<pre>
 6 5
 1.3       2       0       0       3
 2.1       0       4       2.7     0
 1.3       2       0       0       3
 2.1       0       4       2.7     0
 1.3       2       0       0       3
 2.1       0       4       2.7     0</pre>
<p>Example of input matrix in dense format when space=similarity:
 The matrix, when in similarity space, is square and symmetric. 
 The first line specifies the dimensions - #rows/#cols
 From the second line the actual matrix follows.</p>
<pre>
 5
 1.0000   0.3179   0.5544   0.2541   0.4431   
 0.3179   1.0000   0.1386   0.4599   0.5413
 0.5544   0.1386   1.0000   0.5143   0.2186
 0.2541   0.4599   0.5143   1.0000   0.5148
 0.4431   0.5413   0.2186   0.5148   1.0000</pre>
<p>Example of input matrix in sparse format when space=vector:
 The first line specifies the dimensions &amp; number of non-zero elements - #rows #cols #nonzeroElem</p>
<p>From the second line the matrix contents follow. Only non-zero elements are specified. Thus the
elements are specified as pairs of - #col elem. The row number is implied by the (line number-1).</p>
<pre>
 8 10 41
 1 3 4 2 8 2 10 1
 1 1 2 5 3 1 5 2 7 1 9 2
 1 3 4 2 8 2 10 1
 1 1 2 5 3 1 5 2 7 1 9 2
 1 3 4 2 8 2 10 1
 1 1 2 5 3 1 5 2 7 1 9 2
 2 4 3 1 4 2 5 5 7 1 9 1
 2 4 3 1 4 2 5 5 7 1 9 1</pre>
<p>Example of input matrix in sparse format when space=similarity:
 The first line specifies the dimensions &amp; number of non-zero elements - #rows/#cols #nonzeroElem
 The matrix format is same as explained above.</p>
<pre>
 5 15
 1 1.0000 3 0.5544 5 0.4431   
 2 1.0000 3 0.1386 4 0.4599 5 0.5413
 1 0.5544 2 0.1386 3 1.0000
 2 0.4599 4 1.0000
 1 0.4431 2 0.5413 5 1.0000</pre>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Anagha Kulkarni, University of Minnesota, Duluth.</p>
<p>Ted Pedersen, University of Minnesota, Duluth.</p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright (c) 2006-2008,</p>
<pre>
 Ted Pedersen, University of Minnesota, Duluth.
 tpederse@d.umn.edu</pre>
<pre>
 Anagha Kulkarni, University of Minnesota, Duluth.
 kulka020@d.umn.edu</pre>
<p>This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option) any later
version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with
this program; if not, write to</p>
<pre>
 The Free Software Foundation, Inc.,
 59 Temple Place - Suite 330,
 Boston, MA  02111-1307, USA.</pre>

</body>

</html>
